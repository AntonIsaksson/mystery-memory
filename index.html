<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    
    <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    
    <title>How To Find Your Dragon!</title>
</head>
<body>
    <div class="container-fluid mx-auto bg-cards">
        <h1 class="heading col-12 mx-auto">How To Find Your Dragon!</h1>
        <div class="row offset-1 col-10">
            <div class="col-lg-4">
                <div class="card front mx-auto col-12"></div>
            </div>
            <div class="col-lg-4">
                <div class="card front mx-auto col-12"></div>
            </div>
            <div class="col-lg-4">
                <div class="card front mx-auto col-12"></div>
            </div>
        </div>
        <div class="row offset-1 col-10">
            <div class="col-lg-4">
                <div class="card front mx-auto col-12"></div>
            </div>
            <div class="col-lg-4">
                <div class="card front mx-auto col-12"></div>
            </div>
            <div class="col-lg-4">
                <div class="card front mx-auto col-12"></div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {

            initializeGame();
            let flippedCards = [];
            
            //Function 1 - Initialize Game
            function initializeGame() {
            
                let creaturesArray = [0, 0, 1, 1, 2, 2];
                let creaturesImages = [
                    "https://jonathansworlddotcom.files.wordpress.com/2013/07/1-terrible-terror.png",
                    "https://wm.schoolofdragons.com/SoD/Joomla/templates/schoolofdragons/images/SODJ-Gronckle.png",
                    "https://i.pinimg.com/originals/ea/40/13/ea4013c07c1af0fe15b9999ca8afb94a.png"
                ];

                indexArrayShuffled = shuffleArray(creaturesArray);
                
                //Assign cards their indexes
                $('.card').each(function(index) {
                    $(this).attr('data-card-index', indexArrayShuffled[index]);
                    //$(this).append("<span>" + creaturesArrayShuffled[index] + "</span>");
                
                    //Add onClick eventlisteners to all cards
                    $(this).on('click', flipCard);
                    $(this).html("<img class='memoryImg img-"+indexArrayShuffled[index]+"' style='display: none;' src='"+creaturesImages[indexArrayShuffled[index]]+"'>");
                }); 
                //assignCards(creaturesArray); 
            }
            
            function flipCard()Â {
    
                //Push the card index to the array only if the card isn't green already
                flippedCards.push( $(this) );
                $(this).toggleClass('back').toggleClass("front");
                //Show image
                $(this).find('img').css('display','inline');
                //Remove the event listener so we don't register it twice
                $(this).off('click', flipCard);

                let sameCardIndex = false;

                if ( flippedCards.length > 1 && flippedCards[0].data('card-index') == flippedCards[1].data('card-index') ) {
                    sameCardIndex = true;
                }

                //User chooses the correct cards
                if ( (flippedCards.length > 1) && sameCardIndex ) {

                    flippedCards.forEach(card => {
                        card.addClass('correct');
                    });

                    flippedCards = [];

                //Wrong cards or user clicks same card twice
                } else if ( flippedCards.length > 1 && !sameCardIndex) {
                    
                    setTimeout(() => {
                        flippedCards.forEach(element => {
                            //Add the event listener again
                            element.on('click', flipCard);
                            element.toggleClass('back').toggleClass("front");
                            element.find('img').css('display','none');
                        });
                        flippedCards = [];
                    }, 500);

                }

                gameFinished();

            }

            function shuffleArray(arr) {
                for(var j, x, i = arr.length; i; j = parseInt(Math.random() * i), x = arr[--i], arr[i] = arr[j], arr[j] = x);
                return arr;
            }
                        
            function gameFinished() {
            
        }
 
            /*creaturesArray.sort(function(a, b) {
                    return 0.5 - Math.random()
                });*/
            
            
        });
        
    </script>
</body>
</html>